<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel, CSV & PDF Analyzer</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.29/jspdf.plugin.autotable.min.js" defer></script>
    
    <!-- –®—Ä–∏—Ñ—Ç —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∫–∏—Ä–∏–ª–ª–∏—Ü—ã -->
    <script src="https://cdn.jsdelivr.net/npm/jspdf-font@1.0.0/dist/fonts/NotoSans-Regular-normal.js" defer></script>
    
    <!-- –†–µ–∑–µ—Ä–≤–Ω—ã–µ CDN –Ω–∞ —Å–ª—É—á–∞–π –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –æ—Å–Ω–æ–≤–Ω—ã—Ö -->
    <script>
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≥—Ä—É–∑–∫—É –±–∏–±–ª–∏–æ—Ç–µ–∫ –∏ –ø–æ–¥–∫–ª—é—á–∞–µ–º —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
        window.addEventListener('load', function() {
            setTimeout(function() {
                if (!window.jspdf) {
                    console.log('–ü–æ–¥–∫–ª—é—á–∞—é —Ä–µ–∑–µ—Ä–≤–Ω—ã–π CDN –¥–ª—è jsPDF...');
                    const script = document.createElement('script');
                    script.src = 'https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js';
                    document.head.appendChild(script);
                }
                if (!window.html2canvas) {
                    console.log('–ü–æ–¥–∫–ª—é—á–∞—é —Ä–µ–∑–µ—Ä–≤–Ω—ã–π CDN –¥–ª—è html2canvas...');
                    const script = document.createElement('script');
                    script.src = 'https://unpkg.com/html2canvas@latest/dist/html2canvas.min.js';
                    document.head.appendChild(script);
                }
            }, 2000);
        });
    </script>
</head>
<body>
    <div class="container">
        <header>
            <h1>üìä Excel, CSV & PDF Analyzer</h1>
            <p>–ó–∞–≥—Ä—É–∑–∏—Ç–µ Excel, CSV –∏–ª–∏ PDF —Ñ–∞–π–ª –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö</p>
        </header>

        <!-- –§–æ—Ä–º–∞ –∑–∞–≥—Ä—É–∑–∫–∏ -->
        <div class="upload-section" id="uploadSection">
            <div class="upload-area" id="uploadArea">
                <div class="upload-content">
                    <div class="upload-icon">üìÅ</div>
                    <h3>–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª</h3>
                    <p>–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã: .xlsx, .xls, .csv, .pdf</p>
                    <input type="file" id="fileInput" accept=".xlsx,.xls,.csv,.pdf" style="display: none;">
                    <button class="btn btn-primary" onclick="document.getElementById('fileInput').click()">
                        –í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª
                    </button>
                </div>
            </div>
        </div>

        <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ -->
        <div class="loading" id="loading" style="display: none;">
            <div class="spinner"></div>
            <p>–û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é —Ñ–∞–π–ª...</p>
        </div>

        <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ -->
        <div class="results" id="results" style="display: none;">
            <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ñ–∞–π–ª–µ -->
            <div class="file-info">
                <h2>üìÑ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ñ–∞–π–ª–µ</h2>
                <div class="info-grid">
                    <div class="info-item">
                        <span class="label">–§–∞–π–ª:</span>
                        <span class="value" id="fileName"></span>
                    </div>
                    <div class="info-item">
                        <span class="label">–°—Ç—Ä–æ–∫:</span>
                        <span class="value" id="totalRows"></span>
                    </div>
                    <div class="info-item">
                        <span class="label">–°—Ç–æ–ª–±—Ü–æ–≤:</span>
                        <span class="value" id="totalColumns"></span>
                    </div>
                </div>
            </div>

            <!-- –ë–∞–∑–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
            <div class="stats-section">
                <h2>üìà –ë–∞–∑–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
                <div class="stats-grid" id="statsGrid"></div>
            </div>

            <!-- –î–∏–∞–≥—Ä–∞–º–º—ã -->
            <div class="charts-section" id="chartsSection">
                <h2>üìä –î–∏–∞–≥—Ä–∞–º–º—ã</h2>
                <div class="chart-controls">
                    <label for="categorySelect">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é –¥–ª—è –¥–∏–∞–≥—Ä–∞–º–º—ã:</label>
                    <select id="categorySelect" onchange="updateCharts()">
                        <option value="">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä</option>
                    </select>
                </div>
                <div class="charts-grid" id="chartsGrid"></div>
            </div>

            <!-- –¢–∞–±–ª–∏—Ü–∞ –¥–∞–Ω–Ω—ã—Ö -->
            <div class="table-section">
                <h2>üìã –î–∞–Ω–Ω—ã–µ</h2>
                <div class="table-container">
                    <table class="data-table" id="dataTable">
                        <thead id="tableHeader"></thead>
                        <tbody id="tableBody"></tbody>
                    </table>
                </div>
                <div class="table-controls">
                    <button class="btn btn-secondary" id="loadMoreBtn" onclick="loadMoreData()">
                        –ü–æ–∫–∞–∑–∞—Ç—å –µ—â—ë 100 —Å—Ç—Ä–æ–∫
                    </button>
                    <span class="rows-info" id="rowsInfo"></span>
                </div>
            </div>

            <!-- –ê–Ω–∞–ª–∏–∑ –æ—Ç –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ -->
            <div class="ai-section">
                <h2>ü§ñ –ê–Ω–∞–ª–∏–∑ –æ—Ç –Ω–µ–π—Ä–æ—Å–µ—Ç–∏</h2>
                <div class="ai-placeholder" id="aiPlaceholder">
                    <div class="placeholder-content">
                        <div class="placeholder-icon">ü§ñ</div>
                        <p>–ó–¥–µ—Å—å –ø–æ—è–≤–∏—Ç—Å—è –∞–Ω–∞–ª–∏–∑ –æ—Ç –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º —è–∑—ã–∫–µ</p>
                        <p class="ai-note">AI analysis will be provided in English</p>
                        <button class="btn btn-primary" onclick="requestAIAnalysis()">
                            –ó–∞–ø—Ä–æ—Å–∏—Ç—å –∞–Ω–∞–ª–∏–∑
                        </button>
                    </div>
                </div>
                <div class="ai-result" id="aiResult" style="display: none;"></div>
            </div>

            <!-- –ö–Ω–æ–ø–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ PDF -->
            <div class="export-section" id="exportSection" style="display: none;">
                <div class="export-content">
                    <button class="btn btn-success" id="downloadPdfBtn" onclick="generatePDF()">
                        üìÑ –°–∫–∞—á–∞—Ç—å PDF –æ—Ç—á—ë—Ç
                    </button>
                    <div class="export-info">
                        <p>–û—Ç—á—ë—Ç –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ, –≥—Ä–∞—Ñ–∏–∫–∏ –∏ AI –∞–Ω–∞–ª–∏–∑ (–Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º —è–∑—ã–∫–µ)</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ PDF -->
        <div class="pdf-loading" id="pdfLoading" style="display: none;">
            <div class="spinner"></div>
            <p>–ì–µ–Ω–µ—Ä–∏—Ä—É—é PDF –æ—Ç—á—ë—Ç...</p>
        </div>
    </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html> 